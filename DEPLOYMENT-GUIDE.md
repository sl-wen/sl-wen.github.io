# Ubuntu 24.04 éƒ¨ç½²æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

è¿™æ˜¯ä¸€å¥—å®Œæ•´çš„Ubuntu 24.04æœåŠ¡å™¨éƒ¨ç½²è§£å†³æ–¹æ¡ˆï¼Œä¸“é—¨é’ˆå¯¹å†…å­˜ä¸è¶³å¯¼è‡´çš„`SIGKILL`é”™è¯¯è¿›è¡Œäº†ä¼˜åŒ–ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹æ³•1ï¼šè‡ªåŠ¨éƒ¨ç½²ï¼ˆæ¨èï¼‰
GitHub Actionsä¼šè‡ªåŠ¨è¿è¡Œä¼˜åŒ–éƒ¨ç½²ï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œã€‚

### æ–¹æ³•2ï¼šä¸€é”®éƒ¨ç½²
å¦‚æœéœ€è¦æ‰‹åŠ¨éƒ¨ç½²ï¼Œä½¿ç”¨ä¸€é”®éƒ¨ç½²è„šæœ¬ï¼š
```bash
curl -sSL https://raw.githubusercontent.com/sl-wen/sl-wen.github.io/react/deploy-with-optimization.sh | sudo bash
```

### æ–¹æ³•3ï¼šåˆ†æ­¥éƒ¨ç½²
å¦‚æœéœ€è¦æ›´ç²¾ç»†çš„æ§åˆ¶ï¼Œå¯ä»¥åˆ†æ­¥æ‰§è¡Œï¼š

```bash
# 1. å†…å­˜ä¼˜åŒ–
curl -sSL https://raw.githubusercontent.com/sl-wen/sl-wen.github.io/react/optimize-memory.sh | sudo bash

# 2. æ£€æŸ¥çŠ¶æ€
curl -sSL https://raw.githubusercontent.com/sl-wen/sl-wen.github.io/react/check-deployment-status.sh | bash

# 3. å¦‚æœæœ‰é—®é¢˜ï¼Œè¿è¡Œä¿®å¤è„šæœ¬
curl -sSL https://raw.githubusercontent.com/sl-wen/sl-wen.github.io/react/fix-deployment-issues.sh | sudo bash
```

## ğŸ“š è„šæœ¬è¯´æ˜

### 1. `optimize-memory.sh` - å†…å­˜ä¼˜åŒ–è„šæœ¬
**åŠŸèƒ½ï¼š**
- åˆ›å»º1GBäº¤æ¢ç©ºé—´
- æ¸…ç†ç³»ç»Ÿç¼“å­˜
- åœæ­¢ä¸å¿…è¦çš„æœåŠ¡
- ä¼˜åŒ–å†…å­˜ç®¡ç†å‚æ•°
- åŠ¨æ€è°ƒæ•´Node.jså†…å­˜é™åˆ¶

**ä½¿ç”¨åœºæ™¯ï¼š**
- éƒ¨ç½²å‰ä¼˜åŒ–å†…å­˜ç¯å¢ƒ
- è§£å†³å†…å­˜ä¸è¶³é—®é¢˜
- æé«˜ç³»ç»Ÿç¨³å®šæ€§

### 2. `check-deployment-status.sh` - éƒ¨ç½²çŠ¶æ€æ£€æŸ¥
**åŠŸèƒ½ï¼š**
- æ£€æŸ¥ç³»ç»Ÿèµ„æºçŠ¶æ€
- ç›‘æ§æœåŠ¡è¿è¡ŒçŠ¶æ€
- æµ‹è¯•åº”ç”¨å“åº”
- æŸ¥çœ‹æœ€è¿‘æ—¥å¿—
- ç”Ÿæˆä¼˜åŒ–å»ºè®®

**ä½¿ç”¨åœºæ™¯ï¼š**
- å¿«é€Ÿæ£€æŸ¥éƒ¨ç½²çŠ¶æ€
- è¯Šæ–­é—®é¢˜
- ç›‘æ§ç³»ç»Ÿå¥åº·

### 3. `fix-deployment-issues.sh` - é—®é¢˜ä¿®å¤è„šæœ¬
**åŠŸèƒ½ï¼š**
- å¼ºåˆ¶æ¸…ç†æ®‹ç•™è¿›ç¨‹
- é‡æ–°å®‰è£…ä¾èµ–
- é‡æ–°æ„å»ºåº”ç”¨
- ä¿®å¤æœåŠ¡é…ç½®
- æ¢å¤ç³»ç»ŸçŠ¶æ€

**ä½¿ç”¨åœºæ™¯ï¼š**
- éƒ¨ç½²å¤±è´¥åçš„ä¿®å¤
- æ¸…ç†ç³»ç»ŸçŠ¶æ€
- é‡ç½®éƒ¨ç½²ç¯å¢ƒ

### 4. `deploy-with-optimization.sh` - ä¸€é”®éƒ¨ç½²è„šæœ¬
**åŠŸèƒ½ï¼š**
- é›†æˆæ‰€æœ‰ä¼˜åŒ–æªæ–½
- å®Œæ•´çš„éƒ¨ç½²æµç¨‹
- è‡ªåŠ¨é”™è¯¯å¤„ç†
- éƒ¨ç½²çŠ¶æ€éªŒè¯

**ä½¿ç”¨åœºæ™¯ï¼š**
- æ‰‹åŠ¨å®Œæ•´éƒ¨ç½²
- æ›¿ä»£GitHub Actions
- æœ¬åœ°éƒ¨ç½²æµ‹è¯•

### 5. `monitor-deployment.sh` - è¯¦ç»†ç›‘æ§è„šæœ¬
**åŠŸèƒ½ï¼š**
- æ·±åº¦ç³»ç»Ÿç›‘æ§
- è¯¦ç»†è¯Šæ–­æŠ¥å‘Š
- æ€§èƒ½åˆ†æ
- é—®é¢˜å®šä½

**ä½¿ç”¨åœºæ™¯ï¼š**
- æ·±åº¦é—®é¢˜è¯Šæ–­
- æ€§èƒ½ç›‘æ§
- ç³»ç»Ÿåˆ†æ

## ğŸ”§ GitHub Actions å·¥ä½œæµ

### ä¼˜åŒ–ç‰¹æ€§
- **å†…å­˜ç®¡ç†**ï¼šè‡ªåŠ¨å†…å­˜ä¼˜åŒ–å’Œç›‘æ§
- **è¿›ç¨‹ç®¡ç†**ï¼šæ¸©å’Œç»ˆæ­¢ + å¼ºåˆ¶æ¸…ç†
- **é”™è¯¯å¤„ç†**ï¼šè‡ªåŠ¨å¤‡ä»½å’Œå›æ»š
- **è¶…æ—¶æ§åˆ¶**ï¼šé˜²æ­¢æ„å»ºå¡æ­»
- **åˆ†é˜¶æ®µéƒ¨ç½²**ï¼šé€æ­¥éªŒè¯æ¯ä¸ªæ­¥éª¤

### è§¦å‘æ¡ä»¶
- æ¨é€åˆ°`react`åˆ†æ”¯
- æ‰‹åŠ¨è§¦å‘ï¼ˆworkflow_dispatchï¼‰

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. å†…å­˜ä¸è¶³ (SIGKILL)
**ç—‡çŠ¶ï¼š** `Process exited with status 137`
**è§£å†³ï¼š**
```bash
# è¿è¡Œå†…å­˜ä¼˜åŒ–
curl -sSL https://raw.githubusercontent.com/sl-wen/sl-wen.github.io/react/optimize-memory.sh | sudo bash

# æ£€æŸ¥å†…å­˜çŠ¶æ€
free -h
```

#### 2. æœåŠ¡å¯åŠ¨å¤±è´¥
**ç—‡çŠ¶ï¼š** blogæœåŠ¡inactiveæˆ–failed
**è§£å†³ï¼š**
```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
systemctl status blog

# æŸ¥çœ‹æ—¥å¿—
journalctl -u blog -n 20

# é‡å¯æœåŠ¡
sudo systemctl restart blog
```

#### 3. ç«¯å£æœªç›‘å¬
**ç—‡çŠ¶ï¼š** ç«¯å£3000æˆ–80æ— å“åº”
**è§£å†³ï¼š**
```bash
# æ£€æŸ¥ç«¯å£çŠ¶æ€
netstat -tlnp | grep -E ":(80|3000)"

# æ£€æŸ¥åº”ç”¨çŠ¶æ€
curl http://localhost:3000
```

#### 4. æ„å»ºå¤±è´¥
**ç—‡çŠ¶ï¼š** npm run buildå¤±è´¥
**è§£å†³ï¼š**
```bash
# æ¸…ç†ç¼“å­˜
npm cache clean --force

# é‡æ–°å®‰è£…ä¾èµ–
rm -rf node_modules package-lock.json
npm install

# é‡æ–°æ„å»º
npm run build
```

### è¯Šæ–­å‘½ä»¤

```bash
# å¿«é€ŸçŠ¶æ€æ£€æŸ¥
curl -sSL https://raw.githubusercontent.com/sl-wen/sl-wen.github.io/react/check-deployment-status.sh | bash

# è¯¦ç»†ç³»ç»Ÿç›‘æ§
curl -sSL https://raw.githubusercontent.com/sl-wen/sl-wen.github.io/react/monitor-deployment.sh | bash

# å®æ—¶ç›‘æ§
watch -n 5 'curl -sSL https://raw.githubusercontent.com/sl-wen/sl-wen.github.io/react/check-deployment-status.sh | bash'
```

## ğŸ“Š ç³»ç»Ÿè¦æ±‚

### æœ€ä½è¦æ±‚
- **å†…å­˜ï¼š** 1GB (å»ºè®®2GB)
- **ç£ç›˜ï¼š** 10GBå¯ç”¨ç©ºé—´
- **CPUï¼š** 1æ ¸å¿ƒ

### æ¨èé…ç½®
- **å†…å­˜ï¼š** 2GBæˆ–ä»¥ä¸Š
- **ç£ç›˜ï¼š** 20GB SSD
- **CPUï¼š** 2æ ¸å¿ƒ

## ğŸ” å®‰å…¨è€ƒè™‘

### é˜²ç«å¢™è®¾ç½®
```bash
# å¼€æ”¾å¿…è¦ç«¯å£
sudo ufw allow 22    # SSH
sudo ufw allow 80    # HTTP
sudo ufw allow 443   # HTTPS (å¦‚æœä½¿ç”¨SSL)
sudo ufw enable
```

### æƒé™ç®¡ç†
- è„šæœ¬éœ€è¦sudoæƒé™è¿è¡Œ
- åº”ç”¨æ–‡ä»¶å±äºérootç”¨æˆ·
- ç³»ç»ŸæœåŠ¡ä»¥å—é™ç”¨æˆ·è¿è¡Œ

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### å†…å­˜ä¼˜åŒ–
- è‡ªåŠ¨åˆ›å»ºäº¤æ¢ç©ºé—´
- æ¸…ç†ç³»ç»Ÿç¼“å­˜
- ä¼˜åŒ–å†…å­˜å‚æ•°
- åŠ¨æ€è°ƒæ•´Node.jsé™åˆ¶

### æ„å»ºä¼˜åŒ–
- ä½¿ç”¨productionæ¨¡å¼
- å¯ç”¨ç¼“å­˜æ¸…ç†
- è®¾ç½®æ„å»ºè¶…æ—¶
- åˆ†é˜¶æ®µæ„å»ºéªŒè¯

## ğŸ†˜ ç´§æ€¥æ¢å¤

å¦‚æœéƒ¨ç½²å®Œå…¨å¤±è´¥ï¼Œå¯ä»¥ä½¿ç”¨ç´§æ€¥æ¢å¤ï¼š

```bash
# åœæ­¢æ‰€æœ‰æœåŠ¡
sudo systemctl stop blog nginx

# æ¸…ç†æ‰€æœ‰è¿›ç¨‹
sudo pkill -f "next start"
sudo pkill -f "npm start"

# è¿è¡Œå®Œæ•´ä¿®å¤
curl -sSL https://raw.githubusercontent.com/sl-wen/sl-wen.github.io/react/fix-deployment-issues.sh | sudo bash

# é‡æ–°åˆå§‹åŒ–ï¼ˆå¦‚æœéœ€è¦ï¼‰
curl -sSL https://raw.githubusercontent.com/sl-wen/sl-wen.github.io/react/init-server.sh | bash
```

## ğŸ“ æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š
1. è¿è¡Œè¯Šæ–­è„šæœ¬æ”¶é›†ä¿¡æ¯
2. æ£€æŸ¥GitHub Actionsæ—¥å¿—
3. æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—
4. æä¾›è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯

## ğŸ”„ æ›´æ–°æ—¥å¿—

### v2.0 (å½“å‰ç‰ˆæœ¬)
- âœ… å®Œæ•´çš„å†…å­˜ä¼˜åŒ–è§£å†³æ–¹æ¡ˆ
- âœ… è‡ªåŠ¨å¤‡ä»½å’Œå›æ»šæœºåˆ¶
- âœ… åˆ†é˜¶æ®µéƒ¨ç½²éªŒè¯
- âœ… è¯¦ç»†çš„ç›‘æ§å’Œè¯Šæ–­
- âœ… ä¸€é”®éƒ¨ç½²è„šæœ¬

### v1.0 (ä¹‹å‰ç‰ˆæœ¬)
- âŒ å†…å­˜ä¸è¶³å¯¼è‡´SIGKILLé”™è¯¯
- âŒ ç¼ºå°‘é”™è¯¯å¤„ç†æœºåˆ¶
- âŒ ç›‘æ§å’Œè¯Šæ–­ä¸è¶³ 